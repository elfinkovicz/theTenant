<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tenant erstellen - ViralTenant</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary-400: #fbbf24; --primary-500: #f59e0b; --primary-600: #d97706; --dark-400: #9ca3af; --dark-500: #6b7280; --dark-600: #4b5563; --dark-700: #374151; --dark-800: #1f2937; --dark-900: #111827; --dark-950: #030712; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--dark-950); min-height: 100vh; color: #fff; display: flex; align-items: center; justify-content: center; padding: 1rem; }
        .container { width: 100%; max-width: 540px; }
        .card { background: linear-gradient(145deg, rgba(31,41,55,0.9), rgba(17,24,39,0.95)); border: 1px solid var(--dark-700); border-radius: 1rem; padding: 2.5rem; backdrop-filter: blur(10px); box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
        .header { text-align: center; margin-bottom: 2rem; }
        .logo { display: flex; align-items: center; justify-content: center; gap: 0.75rem; margin-bottom: 0.5rem; }
        .logo svg { color: var(--primary-500); }
        .title { font-size: 1.875rem; font-weight: 700; background: linear-gradient(135deg, var(--primary-400), var(--primary-500)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .subtitle { color: var(--dark-400); font-size: 1rem; margin-top: 0.5rem; }
        .form-group { margin-bottom: 1.25rem; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        label { display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem; font-weight: 500; color: var(--dark-400); margin-bottom: 0.5rem; }
        label svg { width: 1rem; height: 1rem; }
        input { width: 100%; padding: 0.875rem 1rem; background: var(--dark-800); border: 1px solid var(--dark-600); border-radius: 0.5rem; color: #fff; font-size: 1rem; font-family: inherit; transition: all 0.2s; }
        input:focus { outline: none; border-color: var(--primary-500); box-shadow: 0 0 0 3px rgba(245,158,11,0.1); }
        input::placeholder { color: var(--dark-500); }
        .subdomain-wrapper { display: flex; }
        .subdomain-wrapper input { border-radius: 0.5rem 0 0 0.5rem; border-right: none; }
        .subdomain-suffix { padding: 0.875rem 1rem; background: var(--dark-900); border: 1px solid var(--dark-600); border-left: none; border-radius: 0 0.5rem 0.5rem 0; color: var(--dark-400); font-size: 0.875rem; }
        .hint { font-size: 0.75rem; color: var(--dark-500); margin-top: 0.375rem; }
        .btn { width: 100%; padding: 1rem; border: none; border-radius: 0.5rem; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.2s; display: flex; align-items: center; justify-content: center; gap: 0.5rem; margin-top: 1.5rem; }
        .btn-primary { background: linear-gradient(135deg, var(--primary-500), var(--primary-600)); color: var(--dark-950); }
        .btn-primary:hover { background: linear-gradient(135deg, var(--primary-400), var(--primary-500)); transform: translateY(-1px); }
        .btn-secondary { background: var(--dark-700); color: #fff; margin-top: 0.75rem; }
        .btn-secondary:hover { background: var(--dark-600); }
        .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .btn svg { width: 1.25rem; height: 1.25rem; }
        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .step { display: none; } .step.active { display: block; }
        .code-input { text-align: center; font-size: 2rem; letter-spacing: 0.5em; font-family: monospace; }
        .result { margin-top: 1.5rem; padding: 1rem; border-radius: 0.5rem; }
        .result.success { background: rgba(34,197,94,0.1); border: 1px solid rgba(34,197,94,0.3); }
        .result.error { background: rgba(239,68,68,0.1); border: 1px solid rgba(239,68,68,0.3); }
        .result-title { font-weight: 600; margin-bottom: 0.5rem; }
        .result.success .result-title { color: #4ade80; }
        .result.error .result-title { color: #f87171; }
        .result-text { font-size: 0.875rem; color: var(--dark-400); line-height: 1.5; }
        .steps-indicator { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; }
        .step-dot { width: 2.5rem; height: 2.5rem; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; background: var(--dark-700); color: var(--dark-400); }
        .step-dot.active { background: var(--primary-500); color: var(--dark-950); }
        .step-dot.done { background: #22c55e; color: #fff; }
        .hidden { display: none !important; }
        @media (max-width: 480px) { .form-row { grid-template-columns: 1fr; } .card { padding: 1.5rem; } .title { font-size: 1.5rem; } }
    </style>
</head>
<body>
<div class="container"><div class="card">
    <div class="header">
        <div class="logo"><svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg><h1 class="title">Neuen Tenant erstellen</h1></div>
        <p class="subtitle">Erstelle deinen eigenen Creator-Space</p>
    </div>
    <div class="steps-indicator"><div class="step-dot active" id="dot1">1</div><div class="step-dot" id="dot2">2</div><div class="step-dot" id="dot3">âœ“</div></div>

    <!-- Step 1: Form -->
    <div id="step1" class="step active">
        <form id="tenantForm">
            <div class="form-row">
                <div class="form-group">
                    <label><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Vorname *</label>
                    <input type="text" id="firstName" required placeholder="Max">
                </div>
                <div class="form-group">
                    <label><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>Nachname *</label>
                    <input type="text" id="lastName" required placeholder="Mustermann">
                </div>
            </div>
            <div class="form-group">
                <label><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>E-Mail-Adresse *</label>
                <input type="email" id="creatorEmail" required placeholder="creator@example.com">
                <p class="hint">An diese Adresse wird ein Verifizierungscode gesendet</p>
            </div>
            <div class="form-group">
                <label><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>Telefonnummer *</label>
                <input type="tel" id="phone" required placeholder="+49 123 456789">
            </div>
            <div class="form-group">
                <label><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"/><path d="M2 12h20"/></svg>Subdomain *</label>
                <div class="subdomain-wrapper">
                    <input type="text" id="subdomain" required placeholder="mein-space" minlength="3" maxlength="20">
                    <span class="subdomain-suffix">.viraltenant.com</span>
                </div>
                <p class="hint">Nur Kleinbuchstaben, Zahlen und Bindestriche (3-20 Zeichen)</p>
            </div>
            <button type="submit" id="submitBtn" class="btn btn-primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>Weiter zur Verifizierung
            </button>
        </form>
        <div id="step1Error" class="result error hidden"><div class="result-title">âœ— Fehler</div><div class="result-text"></div></div>
    </div>

    <!-- Step 2: Verification -->
    <div id="step2" class="step">
        <div style="text-align:center;margin-bottom:1.5rem;">
            <div style="width:4rem;height:4rem;background:rgba(245,158,11,0.2);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1rem;">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"><path d="m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3m-3.5 3.5L19 4"/></svg>
            </div>
            <h2 style="font-size:1.5rem;font-weight:700;margin-bottom:0.5rem;">E-Mail verifizieren</h2>
            <p style="color:var(--dark-400);">Wir haben einen 6-stelligen Code an <span id="emailDisplay" style="color:var(--primary-400);"></span> gesendet.</p>
        </div>
        <form id="verifyForm">
            <div class="form-group">
                <label style="justify-content:center;">Verifizierungscode</label>
                <input type="text" id="verificationCode" class="code-input" maxlength="6" pattern="[0-9]{6}" placeholder="000000" required>
            </div>
            <button type="submit" id="verifyBtn" class="btn btn-primary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg>BestÃ¤tigen
            </button>
            <button type="button" id="backBtn" class="btn btn-secondary">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></svg>ZurÃ¼ck
            </button>
            <p style="text-align:center;margin-top:1rem;"><button type="button" id="resendBtn" style="background:none;border:none;color:var(--primary-400);cursor:pointer;font-size:0.875rem;">Code nicht erhalten? Erneut senden</button></p>
        </form>
        <div id="step2Error" class="result error hidden"><div class="result-title">âœ— Fehler</div><div class="result-text"></div></div>
    </div>

    <!-- Step 3: Success -->
    <div id="step3" class="step">
        <div style="text-align:center;">
            <div style="width:5rem;height:5rem;background:rgba(34,197,94,0.2);border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 1.5rem;">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="#4ade80" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg>
            </div>
            <h2 style="font-size:1.75rem;font-weight:700;color:#4ade80;margin-bottom:1rem;">Tenant erfolgreich erstellt!</h2>
            <p style="color:var(--dark-400);margin-bottom:1.5rem;">Ihre Zugangsdaten wurden an <span id="successEmail" style="color:var(--primary-400);"></span> gesendet.</p>
            <div style="background:var(--dark-800);border-radius:0.5rem;padding:1.5rem;text-align:left;margin-bottom:1.5rem;">
                <h3 style="color:var(--primary-400);font-size:1rem;margin-bottom:1rem;">Ihre Tenant-Informationen</h3>
                <div style="display:flex;justify-content:space-between;margin-bottom:0.75rem;"><span style="color:var(--dark-400);">Subdomain:</span><a id="successUrl" href="#" target="_blank" style="color:var(--primary-400);"></a></div>
                <div style="display:flex;justify-content:space-between;"><span style="color:var(--dark-400);">Tenant-ID:</span><span id="successTenantId" style="font-family:monospace;font-size:0.875rem;"></span></div>
            </div>
            <div style="background:rgba(234,179,8,0.1);border:1px solid rgba(234,179,8,0.3);border-radius:0.5rem;padding:1rem;margin-bottom:1.5rem;">
                <p style="color:#fbbf24;font-size:0.875rem;">ðŸ“§ PrÃ¼fen Sie Ihren Posteingang fÃ¼r die Login-Daten. Schauen Sie auch im Spam-Ordner nach.</p>
            </div>
            <a id="loginLink" href="#" class="btn btn-primary" style="text-decoration:none;"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>Zum Login</a>
        </div>
    </div>
</div></div>
<script>
const API_URL = 'https://ematolm790.execute-api.eu-central-1.amazonaws.com/production';
let formData = {};
document.getElementById('subdomain').addEventListener('input', (e) => { e.target.value = e.target.value.toLowerCase().replace(/[^a-z0-9-]/g, ''); });
document.getElementById('tenantForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = document.getElementById('submitBtn');
    const errorDiv = document.getElementById('step1Error');
    errorDiv.classList.add('hidden');
    formData = { firstName: document.getElementById('firstName').value, lastName: document.getElementById('lastName').value, creatorEmail: document.getElementById('creatorEmail').value, phone: document.getElementById('phone').value, subdomain: document.getElementById('subdomain').value };
    btn.disabled = true;
    btn.innerHTML = '<svg class="spinner" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>Sende Code...';
    try {
        const response = await fetch(`${API_URL}/admin/tenants/send-code`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) });
        const data = await response.json();
        if (!response.ok) throw new Error(data.message || 'Fehler beim Senden');
        document.getElementById('emailDisplay').textContent = formData.creatorEmail;
        document.getElementById('step1').classList.remove('active');
        document.getElementById('step2').classList.add('active');
        document.getElementById('dot1').classList.remove('active');
        document.getElementById('dot1').classList.add('done');
        document.getElementById('dot2').classList.add('active');
    } catch (error) { errorDiv.classList.remove('hidden'); errorDiv.querySelector('.result-text').textContent = error.message; }
    finally { btn.disabled = false; btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></svg>Weiter zur Verifizierung'; }
});
document.getElementById('verifyForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    const btn = document.getElementById('verifyBtn');
    const errorDiv = document.getElementById('step2Error');
    errorDiv.classList.add('hidden');
    const code = document.getElementById('verificationCode').value;
    btn.disabled = true;
    btn.innerHTML = '<svg class="spinner" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>PrÃ¼fe...';
    try {
        const response = await fetch(`${API_URL}/admin/tenants/verify`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email: formData.creatorEmail, code }) });
        const data = await response.json();
        if (!response.ok) throw new Error(data.message || 'Verifizierung fehlgeschlagen');
        document.getElementById('successEmail').textContent = formData.creatorEmail;
        document.getElementById('successTenantId').textContent = data.tenantId;
        document.getElementById('successUrl').textContent = data.url;
        document.getElementById('successUrl').href = data.url;
        document.getElementById('loginLink').href = data.url + '/login';
        document.getElementById('step2').classList.remove('active');
        document.getElementById('step3').classList.add('active');
        document.getElementById('dot2').classList.remove('active');
        document.getElementById('dot2').classList.add('done');
        document.getElementById('dot3').classList.add('done');
    } catch (error) { errorDiv.classList.remove('hidden'); errorDiv.querySelector('.result-text').textContent = error.message; }
    finally { btn.disabled = false; btn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 6 9 17l-5-5"/></svg>BestÃ¤tigen'; }
});
document.getElementById('backBtn').addEventListener('click', () => { document.getElementById('step2').classList.remove('active'); document.getElementById('step1').classList.add('active'); document.getElementById('dot2').classList.remove('active'); document.getElementById('dot1').classList.remove('done'); document.getElementById('dot1').classList.add('active'); });
document.getElementById('resendBtn').addEventListener('click', async () => { const btn = document.getElementById('resendBtn'); btn.disabled = true; btn.textContent = 'Sende...'; try { await fetch(`${API_URL}/admin/tenants/resend-code`, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ email: formData.creatorEmail }) }); btn.textContent = 'Code gesendet!'; setTimeout(() => { btn.textContent = 'Code nicht erhalten? Erneut senden'; btn.disabled = false; }, 3000); } catch (e) { btn.textContent = 'Fehler - erneut versuchen'; btn.disabled = false; } });
document.getElementById('verificationCode').addEventListener('input', (e) => { e.target.value = e.target.value.replace(/\D/g, '').slice(0, 6); });
</script>
</body>
</html>
